## Price Repository

Сервис обеспечивает сохранения данных, полученных от Тинькофф инвестиций. Нужно это только для того, чтобы сначала накопить 
исторические данные, а затем моделировать работу бота на этих данных. Это в свою очередь нужно, что обеспечить 
детерминированную воспроизводимость алгоритмов, связанных с трейдингом (отладка), а также проверить различные 
гипотезы и индикаторы, применяемые в алгоритмах. 

В целом Price Repository носит вспомогательный характер, для прода он не нужен. Однако он важен на этапе разработки, без 
него практически невозможно отлаживать и проверять алгоритмы для трейдинга. 

## sqlx cli 

Очень полезный инструмент, который пригодится при доработке базы: [sqlx cli](https://crates.io/crates/sqlx-cli)

### Установка 
```shell
cargo install sqlx-cli --no-default-features --features postgres
```
### Подготовка переменной окружения
```shell
export DATABASE_URL="postgres://postgres:123456@localhost/tbot"
```
Если подключение к базе через Docker  
```shell
export DATABASE_URL="postgres://postgres:123456@localhost:15432/tbot"
```

### Добавление миграции
```shell
qlx migrate add <name>
```

### Запуск миграций
```shell
sqlx migrate run
```

### Подготовка схемы запросов для режима offline проверки 
```shell
cargo sqlx prepare
```

## Режимы запуска

### Запуск в режиме сохранения данных
```shell
cargo run -- -s
```

### Запуск в режиме чтения данных
```shell
cargo run -- -r 2021-05-07 1
```
1 - скорость чтения данных (2, 3, 4 ...)
